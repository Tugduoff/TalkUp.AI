name: PR Teams Notifications

on:
  pull_request:
    types: [opened, review_requested, closed]
  pull_request_review:
    types: [submitted]

jobs:
  notify-teams:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Notify PR opened
        if: github.event.action == 'opened'
        uses: ./.github/actions/notify-teams
        with:
          webhook: ${{ secrets.TEAMS_WEBHOOK_URL }}
          title: "ðŸ“¥ New Pull Request Opened"
          avatar_url: ${{ github.event.pull_request.user.avatar_url }}
          color: 65535
          description: |
            **By:** `${{ github.actor }}`
            **Title:** `${{ github.event.pull_request.title }}`
          pr_url: ${{ github.event.pull_request.html_url }}

      - name: Notify reviewer requested
        if: github.event.action == 'review_requested'
        uses: ./.github/actions/notify-teams
        with:
          webhook: ${{ secrets.TEAMS_WEBHOOK_URL }}
          title: "ðŸ‘€ Review Requested"
          avatar_url: ${{ github.event.pull_request.user.avatar_url }}
          color: 65535
          description: |
            **Requested:** `${{ github.event.requested_reviewer.login }}`
            \n**By:** `${{ github.actor }}`
          pr_url: ${{ github.event.pull_request.html_url }}

      - name: Notify PR reviewed
        if: github.event.action == 'submitted'
        uses: ./.github/actions/notify-teams
        with:
          webhook: ${{ secrets.TEAMS_WEBHOOK_URL }}
          title: "ðŸ’¬ Pull Request Reviewed"
          avatar_url: ${{ github.event.pull_request.user.avatar_url }}
          description: |
            **Reviewer:** `${{ github.actor }}`
            **PR:** [#${{ github.event.pull_request.number }}](${{ github.event.pull_request.html_url }})
            **Status:** `${{ github.event.review.state }}`
            **Title:** `${{ github.event.pull_request.title }}`
          pr_url: ${{ github.event.pull_request.html_url }}

      - name: Notify PR Merged
        if: github.event.action == 'closed' && github.event.pull_request.merged == true
        uses: ./.github/actions/notify-teams
        with:
          webhook: ${{ secrets.TEAMS_WEBHOOK_URL }}
          title: "âœ… PR Merged"
          avatar_url: ${{ github.event.pull_request.user.avatar_url }}
          description: |
            **By:** `${{ github.actor }}`
            **Title:** `${{ github.event.pull_request.title }}`
          pr_url: ${{ github.event.pull_request.html_url }}

